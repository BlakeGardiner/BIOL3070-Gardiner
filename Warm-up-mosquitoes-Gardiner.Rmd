---
title: "Warm-up mini-Report: Mosquito Blood Hosts in \n Salt Lake City, Utah"
author: "Blake Gardiner"
date: "`r Sys.Date()`"
output:
  github_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# ABSTRACT

West Nile virus (WNV) is maintained in nature through a transmission cycle between birds and mosquitoes, with certain bird species acting as key amplifying hosts. To explore which species may play this role in Salt Lake City, we identified blood meal hosts from field-collected mosquitoes and compared these data with WNV surveillance results. Mosquitoes were collected from multiple locations using standard traps, and DNA from their blood meals was extracted, amplified via PCR, and sequenced to identify host species using BLAST. We then analyzed whether feeding patterns, particularly on house finches (Haemorhous mexicanus), were associated with higher rates of WNV-positive mosquito pools. Our results showed that house finch blood meals were common at sites where WNV was detected, supporting the hypothesis that this species contributes to local virus amplification. These findings highlight the potential importance of house finches in sustaining WNV transmission in urban environments and demonstrate how molecular identification of mosquito blood meals can link host ecology to disease risk.

# BACKGROUND

West Nile virus (WNV) is a mosquito-borne virus that primarily circulates between birds and mosquitoes. Birds are especially important because many species develop high levels of virus in their blood, allowing mosquitoes that feed on them to become infected and continue the transmission cycle. By studying what animals mosquitoes have fed on, we can better understand which hosts might play key roles in maintaining and spreading WNV in an area.

In this project, we analyzed mosquito blood meals collected from sites around Salt Lake City to identify which species mosquitoes were feeding on. Each mosquito was placed in a small tube and homogenized to release DNA from its blood meal. The DNA was then extracted and amplified using PCR, and sequences were compared to reference databases to identify the animal species the mosquito had recently fed upon.

These data allow us to link mosquito feeding patterns with WNV surveillance results. Because some bird species, such as house finches, can maintain detectable levels of viremia for several days (Kumar et al., 2003), they may act as important amplifying hosts. Therefore, we predict that locations where mosquitoes more frequently fed on house finches will also show higher rates of WNV-positive mosquito pools.

```{r viremia, include=TRUE, eval=TRUE, warning=FALSE, fig.align='left', fig.width=4.75, fig.height=7}
# Manually transcribe duration (mean, lo, hi) from the last table column
duration <- data.frame(
  Bird = c("Canada Goose","Mallard", 
           "American Kestrel","Northern Bobwhite",
           "Japanese Quail","Ring-necked Pheasant",
           "American Coot","Killdeer",
           "Ring-billed Gull","Mourning Dove",
           "Rock Dove","Monk Parakeet",
           "Budgerigar","Great Horned Owl",
           "Northern Flicker","Blue Jay",
           "Black-billed Magpie","American Crow",
           "Fish Crow","American Robin",
           "European Starling","Red-winged Blackbird",
           "Common Grackle","House Finch","House Sparrow"),
  mean = c(4.0,4.0,4.5,4.0,1.3,3.7,4.0,4.5,5.5,3.7,3.2,2.7,1.7,6.0,4.0,
           4.0,5.0,3.8,5.0,4.5,3.2,3.0,3.3,6.0,4.5),
  lo   = c(3,4,4,3,0,3,4,4,4,3,3,1,0,6,3,
           3,5,3,4,4,3,3,3,5,2),
  hi   = c(5,4,5,5,4,4,4,5,7,4,4,4,4,6,5,
           5,5,5,7,5,4,3,4,7,6)
)

# Choose some colors
cols <- c(rainbow(30)[c(10:29,1:5)])  # rainbow colors

# horizontal barplot
par(mar=c(5,12,2,2))  # wider left margin for names
bp <- barplot(duration$mean, horiz=TRUE, names.arg=duration$Bird,
              las=1, col=cols, xlab="Days of detectable viremia", xlim=c(0,7))

# add error bars
arrows(duration$lo, bp, duration$hi, bp,
       angle=90, code=3, length=0.05, col="black", xpd=TRUE)
```

# STUDY QUESTION and HYPOTHESIS

## Questions  
What bird species may be serving as the primary amplifying host for West Nile virus (WNV) in Salt Lake City?

## Hypothesis 
House finches play an important role as amplifying hosts for West Nile virus (WNV) in Salt Lake City, contributing to higher transmission rates in areas where they are more common.
  
## Prediction
If house finches serve as key amplifying hosts for WNV, then locations where mosquitoes more frequently feed on house finches should show higher numbers or rates of WNV-positive mosquito pools.

# METHODS

Mosquitoes were collected from several locations across Salt Lake City using a variety of traps designed to capture blood-fed individuals. Each mosquito was placed in a labeled tube for later analysis.

In the lab, we extracted DNA from the mosquitoes by homogenizing them in lysis buffer to release the blood meal DNA. We then used PCR to amplify vertebrate DNA from each sample, which allowed us to detect which animal the mosquito had recently fed on.

The resulting PCR products were sequenced, and the sequences were compared to reference databases using BLAST to identify the most likely host species. These host identifications were then combined with existing data on whether mosquitoes from the same locations tested positive for West Nile virus (WNV).

Finally, we analyzed whether certain bird species, particularly house finches, were associated with higher rates of WNV-positive mosquito pools. Statistical tests and plots were created in R to explore and visualize these relationships.

## First Analysis
In the first analysis, the number of mosquito blood meals was compared from different bird species between sites where WNV  was detected (+) and sites where it wasn’t (-). The barplots were used to show how often mosquitoes fed on each bird species at both types of sites.

From these plots, it looked like mosquitoes collected at WNV-positive locations fed on house finches more often than those collected at WNV-negative sites. This pattern suggested that house finches might be an important host in helping the virus spread. Seeing that difference visually gave the first clue that house finches could be linked to higher WNV activity. The fact that house finches are also fed on more than any other species at WNV-negative sites suggests that mosquitoes may be specifically targeting them as preferred hosts. This could be concerning because it means that the mosquitoes’ preferred source of blood is also one of the best species for maintaining and spreading WNV. 
```{r first-analysis, include=TRUE, eval=TRUE, warning=FALSE, fig.align='left', fig.width=4.75, fig.height=7}
``` 
# Analysis Code

Horizontal plots:
```{r horiz-plot,fig.align='left',fig.width=7,fig.height=7, warning=FALSE}
## import counts_matrix: data.frame with column 'loc_positives' (0/1) and host columns 'host_*'
counts_matrix <- read.csv("./bloodmeal_plusWNV_for_BIOL3070.csv")

## 1) Identify host columns
host_cols <- grep("^host_", names(counts_matrix), value = TRUE)

if (length(host_cols) == 0) {
  stop("No columns matching '^host_' were found in counts_matrix.")
}

## 2) Ensure loc_positives is present and has both levels 0 and 1 where possible
counts_matrix$loc_positives <- factor(counts_matrix$loc_positives, levels = c(0, 1))

## 3) Aggregate host counts by loc_positives
agg <- stats::aggregate(
  counts_matrix[, host_cols, drop = FALSE],
  by = list(loc_positives = counts_matrix$loc_positives),
  FUN = function(x) sum(as.numeric(x), na.rm = TRUE)
)

## make sure both rows exist; if one is missing, add a zero row
need_levels <- setdiff(levels(counts_matrix$loc_positives), as.character(agg$loc_positives))
if (length(need_levels)) {
  zero_row <- as.list(rep(0, length(host_cols)))
  names(zero_row) <- host_cols
  for (lv in need_levels) {
    agg <- rbind(agg, c(lv, zero_row))
  }
  ## restore proper type
  agg$loc_positives <- factor(agg$loc_positives, levels = c("0","1"))
  ## coerce numeric host cols (they may have become character after rbind)
  for (hc in host_cols) agg[[hc]] <- as.numeric(agg[[hc]])
  agg <- agg[order(agg$loc_positives), , drop = FALSE]
}

## 4) Decide species order (overall abundance, descending)
overall <- colSums(agg[, host_cols, drop = FALSE], na.rm = TRUE)
host_order <- names(sort(overall, decreasing = TRUE))
species_labels <- rev(sub("^host_", "", host_order))  # nicer labels

## 5) Build count vectors for each panel in the SAME order
counts0 <- rev(as.numeric(agg[agg$loc_positives == 0, host_order, drop = TRUE]))
counts1 <- rev(as.numeric(agg[agg$loc_positives == 1, host_order, drop = TRUE]))

## 6) Colors: reuse your existing 'cols' if it exists and is long enough; otherwise generate
if (exists("cols") && length(cols) >= length(host_order)) {
  species_colors <- setNames(cols[seq_along(host_order)], species_labels)
} else {
  species_colors <- setNames(rainbow(length(host_order) + 10)[seq_along(host_order)], species_labels)
}

## 7) Shared x-limit for comparability
xmax <- max(c(counts0, counts1), na.rm = TRUE)
xmax <- if (is.finite(xmax)) xmax else 1
xlim_use <- c(0, xmax * 1.08)

## 8) Plot: two horizontal barplots with identical order and colors
op <- par(mfrow = c(1, 2),
          mar = c(4, 12, 3, 2),  # big left margin for species names
          xaxs = "i")           # a bit tighter axis padding

## Panel A: No WNV detected (loc_positives = 0)
barplot(height = counts0,
        names.arg = species_labels, 
        cex.names = .5,
        cex.axis = .5,
        col = rev(unname(species_colors[species_labels])),
        horiz = TRUE,
        las = 1,
        xlab = "Bloodmeal counts",
        main = "(-)WNV Locations",
        xlim = xlim_use)

## Panel B: WNV detected (loc_positives = 1)
barplot(height = counts1,
        names.arg = species_labels, 
        cex.names = .5,
        cex.axis = .5,
        col = rev(unname(species_colors[species_labels])),
        horiz = TRUE,
        las = 1,
        xlab = "Bloodmeal counts",
        main = "(+)WNV Locations",
        xlim = xlim_use)

par(op)

## Keep the colors mapping for reuse elsewhere
host_species_colors <- species_colors
```

## Second Analysis

In the second analysis, a test was ran to see whether or not the number of house finch blood meals could predict whether a site had West Nile virus (WNV).

The first statistical test used a logistic regression, which looked at whether sites with more house finch feedings were more likely to have WNV-positive mosquito pools. The slope for house finch blood meals was 0.347, and the p-value was 0.0287, meaning the relationship had a positive slope and was statistically significant. This shows that as the number of house finch blood meals increases, the odds of finding WNV at that site also go up.

The second test looked at whether the rate of WNV positivity (the proportion of positive mosquito pools) increased with the number of house finch blood meals. In this case, the slope was 0.0275, and the p-value was 4.54 × 10⁻⁵, which is even more significant than the first test. This means that sites where mosquitoes fed on house finches more often also had a higher WNV positivity rate.

Overall, both tests showed a strong, positive relationship between mosquito feeding on house finches and WNV activity across sites, supporting the hypothesis that house finches play a major role in amplifying the virus. The low p-values indicate that these patterns can not be credited to chance nor coincidence. 
```{r second-analysis-or-plot, include=TRUE, eval=TRUE, warning=FALSE, fig.align='left', fig.width=4.75, fig.height=7}
# put code for plotting here
# second-analysis-or-plot, glm with house finch alone against binary +/_
glm1 <- glm(loc_positives ~ host_House_finch,
            data = counts_matrix,
            family = binomial)
summary(glm1)

#glm with house-finch alone against positivity rate
glm2 <- glm(loc_rate ~ host_House_finch,
            data = counts_matrix)
summary(glm2)
```

# DISCUSSION

The results of both analyses support the hypothesis that mosquitoes feeding on house finches are associated with higher West Nile virus (WNV) activity in Salt Lake City. The logistic regression showed a significant positive relationship between house finch blood meals and WNV presence (slope = 0.347, p = 0.0287), indicating that sites with more feedings on house finches were more likely to have WNV-positive mosquito pools. Similarly, the analysis of WNV positivity rate demonstrated a strong positive association (slope = 0.0275, p = 4.54 × 10⁻⁵), meaning that higher numbers of house finch feedings corresponded to higher rates of WNV detection.

These findings align with the background information and the viremia plot from class, which showed that house finches can maintain detectable viral loads for several days, making them efficient amplification hosts. The fact that mosquitoes also feed heavily on house finches at WNV-negative sites suggests that house finches may be a preferred host, which could facilitate virus cycling once introduced.

One limitation of this study is that it focuses on blood meal counts and WNV detection at the site level. Other factors, such as seasonal changes, mosquito abundance, and the presence of other competent hosts, could influence transmission but were not accounted for in this analysis.

# CONCLUSION

In summary, the analyses indicate that mosquito feeding on house finches is positively associated with both the presence and rate of WNV at local sites. These results support the hypothesis that house finches act as important amplifying hosts, and their feeding patterns may help predict areas of higher WNV risk. This study demonstrates the value of linking mosquito blood meal data with virus surveillance to better understand the ecology of mosquito-borne diseases.

# REFERENCES     

1. Komar N, Langevin S, Hinten S, Nemeth N, Edwards E, Hettler D, Davis B, Bowen R, Bunning M. Experimental infection of North American birds with the New York 1999 strain of West Nile virus. Emerg Infect Dis. 2003 Mar;9(3):311-22. https://doi.org/10.3201/eid0903.020628

2. ChatGPT. OpenAI, version Jan 2025. Used as a reference for the code, grammar (like correcting sentence structure, commas, run-on sentences, etc.) correction, brainstorming, and help contexualizing data. Accessed `r Sys.Date()`.



