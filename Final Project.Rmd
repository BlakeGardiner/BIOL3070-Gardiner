---
title: "Final Project"
author: "Blake Gardiner"
date: "`r Sys.Date()`"
output:
  github_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# ABSTRACT



# BACKGROUND




#Insert graph from paper for background info

# STUDY QUESTION and HYPOTHESIS

## Questions  
What effect does genetics and phenotypes have on pain management among European cancer patients who have been treated with opioids?

## Hypothesis 

  
## Prediction
I predict that there will be certain phenotypes and genetics that correspond to lesser pain responses depending on the unique genetic makeup of each demographic.

# METHODS


## First Analysis

```{r}

# Load necessary libraries
library(ggplot2)
library(dplyr)
library(readr)

# 1. Read in the CSV file
data <- read_csv("epos_style_rs12948783_simulated_large.csv")

# 2. Inspect the data
glimpse(data)
summary(data)

# 3. Example 1: Boxplot of normalized pain relief by genotype
ggplot(data, aes(x = genotype, y = norm_pain_relief, fill = genotype)) +
  geom_boxplot(alpha = 0.7) +
  labs(title = "Pain Relief Efficacy by Genotype",
       x = "Genotype",
       y = "Normalized Pain Relief") +
  theme_minimal()
# 4. Example 2: Pain relief by genotype and sex
ggplot(data, aes(x = genotype, y = norm_pain_relief, fill = sex)) +
  geom_boxplot(alpha = 0.7, position = position_dodge(0.8)) +
  labs(title = "Pain Relief Efficacy by Genotype and Sex",
       x = "Genotype",
       y = "Normalized Pain Relief") +
  theme_minimal()

# 5. Example 3: Mean pain relief by genotype and carrier status
data %>%
  group_by(genotype, carrier) %>%
  summarize(mean_relief = mean(norm_pain_relief, na.rm = TRUE)) %>%
  ggplot(aes(x = genotype, y = mean_relief, fill = carrier)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  labs(title = "Mean Pain Relief by Genotype and Carrier Status",
       x = "Genotype",
       y = "Mean Normalized Pain Relief") +
  theme_minimal()

# 6. Example 4: Violin plot comparing pain relief by genotype across countries
ggplot(data, aes(x = genotype, y = norm_pain_relief, fill = country)) +
  geom_violin(alpha = 0.6, trim = FALSE) +
  labs(title = "Pain Relief Efficacy by Genotype Across Countries",
       x = "Genotype",
       y = "Normalized Pain Relief") +
  theme_minimal()




# Load required libraries
library(ggplot2)
library(dplyr)
library(readr)
library(ggpubr)

# 1. Read in the data
data <- read_csv("epos_style_rs12948783_simulated_large.csv")

# 2. Inspect structure
glimpse(data)
summary(data)
names(data)

# 3. One-way ANOVA: Does genotype affect normalized pain relief?
anova_genotype <- aov(norm_pain_relief ~ genotype, data = data)
summary(anova_genotype)

# 4. Pairwise comparison (Tukey HSD)
tukey_results <- TukeyHSD(anova_genotype)
tukey_results

# 5. Boxplot with ANOVA p-value
ggboxplot(data, x = "genotype", y = "norm_pain_relief",
          color = "genotype", palette = "jco",
          add = "jitter", 
          title = "Pain Relief by Genotype") +
  stat_compare_means(method = "anova", label.y = max(data$norm_pain_relief, na.rm = TRUE) * 1.05) +
  theme_minimal()

# 6. Two-way ANOVA: Genotype × Sex
anova_genotype_sex <- aov(norm_pain_relief ~ genotype * sex, data = data)
summary(anova_genotype_sex)

# Boxplot with comparisons between sexes per genotype
ggboxplot(data, x = "genotype", y = "norm_pain_relief",
          fill = "sex", palette = "Set2",
          title = "Pain Relief by Genotype and Sex") +
  stat_compare_means(aes(group = sex), label = "p.signif", method = "t.test",
                     label.y = max(data$norm_pain_relief, na.rm = TRUE) * 1.05) +
  theme_minimal()

# 7. Carrier effect by genotype (two-way ANOVA)
anova_carrier <- aov(norm_pain_relief ~ genotype * carrier, data = data)
summary(anova_carrier)

# Bar plot with mean ± SE by genotype and carrier
data %>%
  group_by(genotype, carrier) %>%
  summarize(mean_relief = mean(norm_pain_relief, na.rm = TRUE),
            se_relief = sd(norm_pain_relief, na.rm = TRUE)/sqrt(n())) %>%
  ggplot(aes(x = genotype, y = mean_relief, fill = carrier)) +
  geom_bar(stat = "identity", position = position_dodge(0.8)) +
  geom_errorbar(aes(ymin = mean_relief - se_relief, ymax = mean_relief + se_relief),
                position = position_dodge(0.8), width = 0.2) +
  labs(title = "Mean Pain Relief by Genotype and Carrier Status",
       x = "Genotype",
       y = "Mean ± SE Normalized Pain Relief") +
  theme_minimal()

# 8. Violin plot with country comparisons (Kruskal-Wallis)
ggviolin(data, x = "genotype", y = "norm_pain_relief",
         fill = "country", palette = "Paired",
         title = "Pain Relief Efficacy by Genotype Across Countries") +
  stat_compare_means(method = "kruskal.test",
                     label.y = max(data$norm_pain_relief, na.rm = TRUE) * 1.05) +
  theme_minimal()
```
# Analysis Code


## Second Analysis

In the second analysis, a test was ran to see whether or not the number of house finch blood meals could predict whether a site had West Nile virus (WNV).

The first statistical test used a logistic regression, which looked at whether sites with more house finch feedings were more likely to have WNV-positive mosquito pools. The slope for house finch blood meals was 0.347, and the p-value was 0.0287, meaning the relationship had a positive slope and was statistically significant. This shows that as the number of house finch blood meals increases, the odds of finding WNV at that site also go up.

The second test looked at whether the rate of WNV positivity (the proportion of positive mosquito pools) increased with the number of house finch blood meals. In this case, the slope was 0.0275, and the p-value was 4.54 × 10⁻⁵, which is even more significant than the first test. This means that sites where mosquitoes fed on house finches more often also had a higher WNV positivity rate.

Overall, both tests showed a strong, positive relationship between mosquito feeding on house finches and WNV activity across sites, supporting the hypothesis that house finches play a major role in amplifying the virus. The low p-values indicate that these patterns can not be credited to chance nor coincidence. 
```{r second-analysis-or-plot, include=TRUE, eval=TRUE, warning=FALSE, fig.align='left', fig.width=4.75, fig.height=7}
# put code for plotting here
# second-analysis-or-plot, glm with house finch alone against binary +/_
glm1 <- glm(loc_positives ~ host_House_finch,
            data = counts_matrix,
            family = binomial)
summary(glm1)

#glm with house-finch alone against positivity rate
glm2 <- glm(loc_rate ~ host_House_finch,
            data = counts_matrix)
summary(glm2)
```

# DISCUSSION

The results of both analyses support the hypothesis that mosquitoes feeding on house finches are associated with higher West Nile virus (WNV) activity in Salt Lake City. The logistic regression showed a significant positive relationship between house finch blood meals and WNV presence (slope = 0.347, p = 0.0287), indicating that sites with more feedings on house finches were more likely to have WNV-positive mosquito pools. Similarly, the analysis of WNV positivity rate demonstrated a strong positive association (slope = 0.0275, p = 4.54 × 10⁻⁵), meaning that higher numbers of house finch feedings corresponded to higher rates of WNV detection.

These findings align with the background information and the viremia plot from class, which showed that house finches can maintain detectable viral loads for several days, making them efficient amplification hosts. The fact that mosquitoes also feed heavily on house finches at WNV-negative sites suggests that house finches may be a preferred host, which could facilitate virus cycling once introduced.

One limitation of this study is that it focuses on blood meal counts and WNV detection at the site level. Other factors, such as seasonal changes, mosquito abundance, and the presence of other competent hosts, could influence transmission but were not accounted for in this analysis.

# CONCLUSION

In summary, the analyses indicate that mosquito feeding on house finches is positively associated with both the presence and rate of WNV at local sites. These results support the hypothesis that house finches act as important amplifying hosts, and their feeding patterns may help predict areas of higher WNV risk. This study demonstrates the value of linking mosquito blood meal data with virus surveillance to better understand the ecology of mosquito-borne diseases.

# REFERENCES     

1. Komar N, Langevin S, Hinten S, Nemeth N, Edwards E, Hettler D, Davis B, Bowen R, Bunning M. Experimental infection of North American birds with the New York 1999 strain of West Nile virus. Emerg Infect Dis. 2003 Mar;9(3):311-22. https://doi.org/10.3201/eid0903.020628

2. ChatGPT. OpenAI, version Jan 2025. Used as a reference for the code, grammar (like correcting sentence structure, commas, run-on sentences, etc.) correction, brainstorming, and help contexualizing data. Accessed `r Sys.Date()`.

# Install the packages if not already done
# install.packages("ggplot2")
# install.packages("geomtextpath")

# Load the package
library(ggplot2)

install.packages("geomtextpath")
ggplot2:


